# 差分数组


# 差分数组

如果给你一个包含5000万个元素的数组，然后会有频繁区间修改操作，那什么是频繁的区间修改操作呢？比如让第1个数到第1000万个数每个数都加上1，而且这种操作时频繁的。

此时你应该怎么做？很容易想到的是，从第1个数开始遍历，一直遍历到第1000万个数，然后每个数都加上1，如果这种操作很频繁的话，那这种暴力的方法在一些实时的系统中可能就拉跨了。

因此，今天的主角就出现了——差分数组。

---

## 1.定义

差分数组就是与原数组同样大小的数组

原数组记为:a[]

差分数组记为:d[]

```
公式:
1.i=1时 d[i]=a[i]
2.i>1时,d[i]=a[i]-a[i-1]

恢复公式
a[i]=d[i]+a[i-1]
```

| index | 0   | 1   | 2   | 3   | 4   |
|:-----:| --- | --- | --- | --- | --- |
| 原数组a  | 1   | 3   | 7   | 5   | 2   |
| 差分d   | 1   | 2   | 4   | -2  | -3  |
| sum.d | 1   | 3   | 7   | 5   | 2   |

---

## 2.差分数组的应用:区间的快速加减

对区间[L,R]统一加上X,只需要在差分数组d[L]+X,d[R+1]-X即可

例如，对区间[1,3]加3

| index | 0   | 1   | 2   | 3   | 4   |
|:-----:| --- | --- | --- | --- | --- |
| 原数组   | 1   | 3   | 7   | 5   | 2   |
| 原差分d  | 1   | 2   | 4   | -2  | -3  |
| 减差分   | 1   | 5   | 4   | -2  | 0   |
| 还原数组  | 1   | 6   | 10  | 8   | 2   |

